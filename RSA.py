import rsa
from base64 import b64encode,b64decode

class RS:
    def encryptMsg(message, n,e):                   #Target Public key (e,n)     e=public
        public_key=rsa.PublicKey(n,e)
        return rsa.encrypt(message, public_key)
        
    def decryptMsg(encrypted_message, n,e,d,p,q):   #Bizim Private key (d,n)     d=private
        private_key=rsa.PrivateKey(n,e,d,p,q)
        return rsa.decrypt(encrypted_message, private_key)

if __name__=="__main__":
    message = b"gxf"
    
    #public_key, private_key = rsa.newkeys(2048)
    #print(public_key.n,public_key.e)
    #print("d",private_key.d)
    #print("p",private_key.p)
    #print("q",private_key.q)

    #public_key=rsa.PublicKey(n,e)
    #private_key=rsa.PrivateKey(n,e,d,p,q)
    
    public_key=rsa.PublicKey(
        503591335186393219362889058875513766185804175254109841161520658964614292349823588540946661286490466767854226576389672711627538641038240551013036239537643245460385619223907071388933454208741389530272784408731696885658361131973085790842971472241866141893503848051609861423936927929796982988569969641192672566077365607387225816042626482830407708080840651910911102998057739363283671979542950045317602257245310357511498769813886945677383901580035019803766408962137072770801034427475510071758106668830305030369075578330623931003348776294513185618757699750172885454949220251388412918312683870681600997384775911908019360587549355183608433892936411728518021528430915893695482341852653328668011806434443245813034454967487331193332859674791464004099179380337453821070497699052531619292036159071161101399309502823943099773571025949598025010571431170804601042469961517718074313051028428826250832213371937152286374050391585340065519048565313368370590769269640605796050204466797878006129324023839830461892279420173644609013197921073059997351097022586541424071212128971998473820078654222151966945371876853900649439428581505761232322013742127825541317660750535378446809580887728809048408442330988755578068116967245356124202944034643627256091431825631,
        65537)
    
    private_key=rsa.PrivateKey(503591335186393219362889058875513766185804175254109841161520658964614292349823588540946661286490466767854226576389672711627538641038240551013036239537643245460385619223907071388933454208741389530272784408731696885658361131973085790842971472241866141893503848051609861423936927929796982988569969641192672566077365607387225816042626482830407708080840651910911102998057739363283671979542950045317602257245310357511498769813886945677383901580035019803766408962137072770801034427475510071758106668830305030369075578330623931003348776294513185618757699750172885454949220251388412918312683870681600997384775911908019360587549355183608433892936411728518021528430915893695482341852653328668011806434443245813034454967487331193332859674791464004099179380337453821070497699052531619292036159071161101399309502823943099773571025949598025010571431170804601042469961517718074313051028428826250832213371937152286374050391585340065519048565313368370590769269640605796050204466797878006129324023839830461892279420173644609013197921073059997351097022586541424071212128971998473820078654222151966945371876853900649439428581505761232322013742127825541317660750535378446809580887728809048408442330988755578068116967245356124202944034643627256091431825631,
    65537,
    93868681060118399800678284682290555987087962599816986124313538457844091053076047997561750069056678548546732866276702348982132414344921900165940624413565617689916699336851683538874392734088908776749200212659511560724515000506327967727203556844326667216550086329836063096492264088841416973440510690706161222930575068432219213097589531322096839371889915677307323103350372218164904357875653108222833348711547848198124249996894012975798735701995938201669445532774867341625424364344428811764301555860521632833187775834824632515020654763168486130258389309063765029184425203945265303723205916722560351924140905745889566335610942303995049878868019564179107959345473053725635477411088412973143037067892554996728075382828125096881057263677670649080443322002822118051741459433942888054572153644329884031865485085429085952097296893224635208362332939761348943760566436894660963845689545577322503301521960862330213067135350883491592505058171588658087955230113986637359825590483846075167395201665151196297138666511026814255719797319956027996808171353117237335442184603682296088236467434490683021003180891192534562022328682791333121553950263381197608030074859736514624474716651829096590721435581076983366868360348866088313411821295340252039666477825,
    29439036903783540149841636108901138070466091447946624604586589610154935260280667221253451155860310879339034829261824617106365185756341590961628830877487813058121139345656536960988211293524084281085826363634073235738208134514215245621565404561405561962406758576368933685989690741188199616224360795594819517335717617297844457677478599222375331301178699366146094308182150029911171724491196917012389348283167331671125366679990163181632611948165666272479865589278422360660290246717633403175536653509953323057282922668533367867114168542600316607755921041326040090018025785795774565798132431180625673404556703357942776109199,
    17106243551115324023194341131599243370905964492380815226905858162238401927398140410660516224494830196582736937078141242855206631213483452214551577169615265432302770757884426111834037433843540210674414837170327212747252679943011392195789484574039773718373164314961720165246952613248209324405478404049244226383705819353271006916656084647295461760614281764717547059180190750274691783179732865062603893929549001073978112523345270119042970497021524088630765855023520587700661094242189448887511544777834435492048726177509944107076438663616716925366155269072788611749466158857366042022732470062290755360585228245076977429169)
    
    encrypted_message = b64decode("EQvtyaCbizag02Knq5QbIzxJdov0MuE7u8Up+GWH+rh4VsX1byQyptYCAbRAEeGvN0v0Z8IHf0L7gs2mn2FUpwPy7O9ZOak1r8qfA3v6kiRF3+Vvz4psw1uCb/GHATIw2nPKeiI09UCKjKhwW1k4det19K3TsRcJ8a/5biP9hJdtsQBjmR0jbGZuL2HT562iKZjceDZF4QlLshfHNNv+JNC2NNOrp/UvZVqKhKYA+9m3fEtUV8DQQxGpwtZdRuMsLdBWbR8v1fYgDqHk1z6Aq9hMEG8mcHd9D6tS5ZL5bldDtX3qtdOjlkPmU/fxS/lPqB7d85yZBv88GQIOTQlfyIWvec1+OwtvrojqLcSvJoY9VlpjAvWciYKE8pf2F/pP8Q3EaxG8C/zOiqueQVLYllLaHvFRa2MHSuDthMjAIKtW2rwFAfw5zqCHBht6d+QFbiWRAXPB6nHQVt8MQDUZZEZSwj/xpbVrD8dJf6IDFacHtjdMtMWvpTn4EXCu7EstvaZ4XNS5ThLdFvHPCGsb1ydCoILgtAy1NzMFNRNfCeJQ9xebuhLMAixtKUbcgI5l/DJlppU2tRc3+aPGtJgM0su/v7kh9+gBWeDsWI6VqEUsc20INCO0ElACtdkFPsntyt91cte3rhTQ1lMplRZOfvWi5XFr3GlCvW02PfCqmeI=")
    decrypted_message = rsa.decrypt(encrypted_message, private_key)
    print(encrypted_message)
    print(decrypted_message)
    print(b64decode("o9Rg9xDHizngl60fCDoNt+EkIdeOwZTPFFOCCYptcUs="))